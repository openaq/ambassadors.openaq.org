---
import PageLayout from "@layouts/PageLayout.astro";
import { getCollection, render, type CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import SocialIcons from "@components/people/SocialIcons.astro";

export async function getStaticPaths() {
  const projects = await getCollection("projects");

  return [...projects].map((project) => ({
    params: { slug: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;

const { Content } = await render(project);
---

<style lang="scss">
  @use "openaq-design-system/scss/variables" as variables;
  @use "openaq-design-system/scss/mixins/index" as mixins;

  .project-content {
    display: flex;
    justify-content: center;
    margin: 0 0 100px;
    position: relative;

    .project {
      display: flex;
      flex-direction: column;

      &__img {
        width: 300px;
        height: auto;
      }

      .project-description {
        border-top: 6px solid variables.$sky100;

        .project-name {
          @include mixins.display1;
          margin: 40px 0 0 0;
        }

        .project-title {
          @include mixins.heading1;
          color: variables.$sky120;
          margin: 0 0 40px 0;
        }

        .project-quote {
          @include mixins.body1;
          margin: 40px 0;
        }

        .project-bio {
          margin: 40px 0;

          h1,
          h2,
          h3,
          h4 {
            color: variables.$sky120;
            @include mixins.heading2;
          }

          p {
            @include mixins.body2;
            margin: 15px 0;
          }
        }
      }
    }
  }

  .project-image-placeholder {
    position: relative;
    overflow: hidden;
    width: 252px;
    height: 252px;

    .bubble-md {
      position: absolute;
      bottom: -14px;
    }

    .bubble-sm {
      position: absolute;
      bottom: -14px;
    }
  }
</style>

<PageLayout frontmatter={project.data}>
  <div class="project-content">
    <article class="project">
      <Image
        src={project.data.image}
        height={300}
        width={300}
        loading="eager"
        alt=`${project.data.name} portrait`
      />

      <div class="project-description">
        <h1 class="project-name gradient-title">{project.data.name}</h1>
        <h2 class="project-title">Project</h2>
        <div class="project-bio"><Content /></div>
      </div>
    </article>
  </div></PageLayout
>
